---
version: 0.2
phases:
  build:
    commands:
      # setup.py must be run from inside the directory.
      - cd common
      - python setup.py bdist_wheel -d ../build
      - cd ..
      - cd cli
      - python setup.py bdist_wheel -d ../build
      - cd ..
      - pip install --find-links=build determined-common determined-cli
      # Ensure Determined cli can run without installing cli test requirements
      - det --help
  post_build:
    commands:
      - pip install -r tests/cli/requirements.txt
      - pytest tests/cli
